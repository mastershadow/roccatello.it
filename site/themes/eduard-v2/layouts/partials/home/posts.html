{{ $ := .root }}
{{ $page := .page }}
{{ $posts_len := len (where (where $.Site.RegularPages "Type" "post") ".Params.notonhomepage" nil) }}

<section id="posts">
  <div class="container">

    <!-- Blog Posts widget -->
    <div class="row">
      <div class="col-12 section-heading">

        <h1>{{ with $page.Title }}{{ . | markdownify }}{{ end }}</h1>
        {{ with $page.Params.subtitle }}<p>{{ . | markdownify }}</p>{{ end }}

      </div>
    </div>
    <div class="row">
      <div class="col-12">
        {{ with $page.Content }}<p>{{ . | markdownify }}</p>{{ end }}
        {{ $posts := where (where $.Site.RegularPages "Type" "post") ".Params.notonhomepage" nil }}
        <ul class="list-unstyled">
          {{ range $post := first $page.Params.count $posts }}
          <li class="media mb-3">
            <div class="icon mr-3"><i class="fas fa-newspaper fa-2x"></i></div>
            <div class="media-body">
              <h5 class="mt-0 mb-1 font-weight-bold"><a href="{{ $post.RelPermalink }}"
                  itemprop="url">{{ $post.Title }}</a></h5>
              {{ $post.Summary }}
            </div>
          </li>
          {{ end }}
        </ul>

      </div>
    </div>
    <div class="row">
      <div class="col-12">
        {{ if gt $posts_len $page.Params.count }}
        <p class="view-all text-right">
          <a class="font-weight-bold" href="{{ ($.Site.GetPage "section" "post").RelPermalink }}">
            {{ i18n "more_posts" | markdownify }}
            <i class="fas fa-angle-double-right"></i>
          </a>
        </p>
        {{ end }}
      </div>
    </div>
  </div>
</section>
